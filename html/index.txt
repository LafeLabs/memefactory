<div id = "page">
<table id = "linktable">
    <tr>
        <td>
            <a href = "editor.php">
                <img src = "mapicons/editor.svg"/>
            </a>
        </td>
        <td>
            <a href = "imagefeed.php">
                <img src = "mapicons/imagefeed.svg"/>
            </a>
        </td>
        <td>
            <a id = "linkerlink" href = "linker.php">
                <img src = "mapicons/combiner.svg"/>
            </a>
        </td>
        <td>
            <a id = "alignerlink" href = "aligner.php">
                <img src = "mapicons/aligner.svg"/>
            </a>
        </td>
        <td>
            <a href = "map2link.php">
                <img src = "mapicons/memefeed.svg"/>
            </a>
        </td>
        <td>
            <a href = "copy.php">
                <img src = "mapicons/copy.svg"/>
            </a>
        </td>
    </tr>
</table>
</div>
<script>

linkimages = document.getElementById("linktable").getElementsByTagName("img");
for(var index = 0;index < linkimages.length;index++){
    linkimages[index].style.width = (innerWidth/16).toString() + "px";
}

    map = JSON.parse(document.getElementById("datadiv").innerHTML);
    url = document.getElementById("urldiv").innerHTML;
    path = document.getElementById("pathdiv").innerHTML;
    if(path.length > 1){
        pathset = true;
    }
    else{
        pathset = false;
    }
    if(url.length > 1){
        urlset = true;
    }
    else{
        urlset = false;
    }
    
    if(urlset && !pathset){
        data = encodeURIComponent(JSON.stringify(map,null,"    "));
        var httpc = new XMLHttpRequest();
        var url = "filesaver.php";
        httpc.open("POST", url, true);
        httpc.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
        httpc.send("data=" + data + "&filename=" + "json/map.txt");//send text to filesaver.php
    }
    if(urlset && pathset){
        data = encodeURIComponent(JSON.stringify(map,null,"    "));
        var httpc = new XMLHttpRequest();
        var url = "filesaver.php";
        httpc.open("POST", url, true);
        httpc.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
        httpc.send("data=" + data + "&filename=" + path);//send text to filesaver.php
    }    
    if(pathset){
        document.getElementById("linkerlink").href += "?path=" + path; 
        document.getElementById("alignerlink").href += "?path=" + path; 
        document.getElementById("mapeditorlink").href += "?path=" + path; 
    }
    
    for(var index = 0;index < map.length;index++){
        var newimg = document.createElement("IMG");
        var newa = document.createElement("A");
        newa.className = "linkbox";
        newa.appendChild(newimg);
        newa.id = "a" + index.toString();
        newa.href = map[index].href;
        newimg.id = "i" + index.toString();
        document.getElementById("page").appendChild(newa);
        newimg.src = map[index].src;
        newa.style.left = (map[index].x*innerWidth).toString() + "px";
        newa.style.top = (map[index].y*innerWidth).toString() + "px";
        newa.style.width = (map[index].w*innerWidth).toString() + "px";
        newa.style.transform = "rotate(" + map[index].angle.toString() + "deg)";
        newimg.onload = function(){
            this.parentElement.style.height = (this.height).toString() + "px";
        }
    }
    
</script>
<style>
#linktable{
    position:absolute;
    left:0px;
    top:0px;
    z-index:9999999;
}
#linktable img{
    width:40px;
}
#page{
    position:absolute;    
    left:0px;
    top:0px;
    right:0px;
    bottom:0px;
}
.linkbox{
    position:absolute;
}
.linkbox img{
    position:absolute;
    left:0px;
    top:0px;
    width:100%;
}
</style>